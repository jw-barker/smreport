import requests

# Replace these values with your Okta API credentials
okta_domain = 'your-okta-domain'
api_token = 'your-okta-api-token'

# Function to send API requests with authorization headers
def send_request(url):
    headers = {
        'Authorization': 'SSWS ' + api_token,
        'Accept': 'application/json',
    }
    response = requests.get(url, headers=headers)
    return response.json()

# Retrieve number of Okta users
users_url = f'https://{okta_domain}/api/v1/users'
users_response = send_request(users_url)
num_users = len(users_response)
print(f'Number of Okta users: {num_users}')

# Retrieve list of applications and number of users using each app
apps_url = f'https://{okta_domain}/api/v1/apps'
apps_response = send_request(apps_url)
app_count = len(apps_response)
print(f'Number of applications: {app_count}')
print('Applications and number of users:')
for app in apps_response:
    app_name = app['label']
    app_users_url = app['_links']['users']['href']
    app_users_response = send_request(app_users_url)
    app_users_count = len(app_users_response)
    print(f'{app_name}: {app_users_count} users')
